---
title: "HSC Autoinstall"
year: 2020
lang: "cs"
logo: "../../images/hsc-logo.png"
active: true
wip: false
tags:
  - ".NET"
  - "PowerShell"
---

Jak je všem známo, v roce 2020 byl svět zasažen pandemií nemoci COVID-19. Kvůli této pandemii přešla má vysoká škola na plně distanční výuku a po uvolnění lockdownu jsem tedy měl výrazně více času pracovat. Ve společnosti <a href="https://hsccomputers.cz" target="_blank" rel="noopener noreferrer">HSC Computers</a>, kde jsem před lockdownem pracoval jednou týdně, jsem tedy mohl pracovat několik dní v týdnu.

Tou dobou velké množství zákazníků nakupovalo nové počítače ve velkém množství a každy z nových počítačů musel být předinstalován a vybaven programy dle potřeb zákazníka. Jako programátor jsem si přirozeně chtěl co nejvíce zjednodušit práci a automatizovat maximum tohoto procesu. Zřizovací balíčky, které jsou pro toto ve Windows určené, nebyly příliš spolehlivé a některé aplikace se pomocí nich nainstalovat nedaly. Vytvořil jsem tedy v .NET Core konzolovou aplikaci, která z JSON konfigurace vytvořila PowerShell skript vykonávající chtěné operace a společně s instalátory programů jej zabalila do spustitelného balíčku.

Velkým pokrokem bylo, když jsem objevil službu <a href="https://chocolatey.org" target="_blank" rel="noopener noreferrer">Chocolatey</a>, která poskytuje nástroj příkazové řádky pro instalaci aplikací z jejich obsáhlého registru &ndash; je v podstatě obdobou linuxových správců balíčků Aptiutude nebo Yum, ale pro Windows. Tyto instalace hlavně zpravidla nevyžadují žádný zásah uživatele, což extrémně zrychluje instalaci. Chocolatey jsem si natolik oblíbil, že jej používám běžně i na jednorázové instalace - i instalace Chocolatey je velmi jednoduchá a poté nemusím vyhledávat instalátory aplikací ať na svých flash discích, tak na Internetu.

Výsledek také nebyl úplně spolehlvý, ale po pár měsících ladění jsem program dostal do stavu, kdy bylo velmi rychlé a jednoduché při přijetí zásilky počítačů vytvořit instalátor pro daného zákazníka a paralelně předinstalovávat několik počítačů pouze s minimálním zásahem z mé strany. Navíc se JSON konfigurace ukázaly jako dobrý doplněk dokumentace, jelikož obsahovaly softwarovou výbavu, uživatelské účty, připojení do domény a další informace.
